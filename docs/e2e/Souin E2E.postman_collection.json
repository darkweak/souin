{
	"info": {
		"_postman_id": "b6c5c6c2-51b9-4ee7-a3eb-d84d0a67aa84",
		"name": "Souin E2E",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Caddy",
			"item": [
				{
					"name": "Default",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'caddy_url')}/default`, '', true)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{caddy_url}}/default",
							"host": [
								"{{caddy_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Souin api",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.souinAPI.listKeys(pm, 'GET-localhost:4443-/test1', utils.getVar(pm, 'caddy_url'), '/test1')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{caddy_url}}{{souin_base_api}}{{souin_api}}",
							"host": [
								"{{caddy_url}}{{souin_base_api}}{{souin_api}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Souin api GraphQL",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.souinAPI.listGraphQLKeys(pm, 'POST-localhost:4443-/test1-4d08c8e90fed197693d96603c73fa6036e7ce42b8de0149cdd33b34e980631e2', utils.getVar(pm, 'caddy_url'), '/test1');"
								],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\"query\":\"something\"}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{caddy_url}}{{souin_base_api}}{{souin_api}}",
							"host": [
								"{{caddy_url}}{{souin_base_api}}{{souin_api}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Max age",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.validateAge(pm, 4, `${utils.getVar(pm, 'caddy_url')}/cache-maxage`)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{caddy_url}}/cache-maxage",
							"host": [
								"{{caddy_url}}"
							],
							"path": [
								"cache-maxage"
							]
						}
					},
					"response": []
				},
				{
					"name": "SMax age",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.validateAge(pm, 9, `${utils.getVar(pm, 'caddy_url')}/cache-s-maxage`)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{caddy_url}}/cache-s-maxage",
							"host": [
								"{{caddy_url}}"
							],
							"path": [
								"cache-s-maxage"
							]
						}
					},
					"response": []
				},
				{
					"name": "Prometheus api",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Prometheus respond well.\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Prometheus is populated.\", function () {",
									"    const result = pm.response.text();",
									"    pm.expect(result).to.include('souin_request_counter 10');",
									"    pm.expect(result).to.include('souin_no_cached_response_counter 7');",
									"    pm.expect(result).to.include('souin_cached_response_counter 3');",
									"    pm.expect(result).to.include('souin_avg_response_time_count 7');",
									"    pm.expect(result).to.include('souin_avg_response_time_sum 0');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{caddy_url}}{{souin_base_api}}{{prometheus_api}}",
							"host": [
								"{{caddy_url}}{{souin_base_api}}{{prometheus_api}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no cache",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'caddy_url')}/default`, 'no-cache')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{caddy_url}}/default",
							"host": [
								"{{caddy_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Vary",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.validateVary(pm, `${utils.getVar(pm, 'caddy_url')}/vary`)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-something",
								"value": "should-vary-1",
								"type": "text"
							},
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{caddy_url}}/vary",
							"host": [
								"{{caddy_url}}"
							],
							"path": [
								"vary"
							]
						}
					},
					"response": []
				},
				{
					"name": "Serve HTTP errored",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.serveHTTPError(pm, `${utils.getVar(pm, 'caddy_url')}/no-reverse-proxy`)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-something",
								"value": "should-vary-1",
								"type": "text"
							},
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{caddy_url}}/no-reverse-proxy",
							"host": [
								"{{caddy_url}}"
							],
							"path": [
								"no-reverse-proxy"
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no store",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'caddy_url')}/default`, 'no-store')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "no-store",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{caddy_url}}/default",
							"host": [
								"{{caddy_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Exclude regex",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'caddy_url')}/test2`, '', false, true)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{caddy_url}}/test2",
							"host": [
								"{{caddy_url}}"
							],
							"path": [
								"test2"
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "Echo",
			"item": [
				{
					"name": "Default",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'echo_url')}/default`, '', true)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{echo_url}}/default",
							"host": [
								"{{echo_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no cache",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'echo_url')}/default`, 'no-cache')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{echo_url}}/default",
							"host": [
								"{{echo_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no store",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'echo_url')}/default`, 'no-store')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "no-store",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{echo_url}}/default",
							"host": [
								"{{echo_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Exclude regex",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'echo_url')}/test2`, '', false, true)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{echo_url}}/excluded",
							"host": [
								"{{echo_url}}"
							],
							"path": [
								"excluded"
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "Chi",
			"item": [
				{
					"name": "Default",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'chi_url')}/default`, '', true)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{chi_url}}/default",
							"host": [
								"{{chi_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no cache",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'chi_url')}/default`, 'no-cache')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{chi_url}}/default",
							"host": [
								"{{chi_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no store",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'chi_url')}/default`, 'no-store')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "no-store",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{chi_url}}/default",
							"host": [
								"{{chi_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Exclude regex",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'chi_url')}/test2`, '', false, true)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{chi_url}}/excluded",
							"host": [
								"{{chi_url}}"
							],
							"path": [
								"excluded"
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "Gin",
			"item": [
				{
					"name": "Default",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'gin_url')}/default`, '', true)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{gin_url}}/default",
							"host": [
								"{{gin_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no cache",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'gin_url')}/default`, 'no-cache')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{gin_url}}/default",
							"host": [
								"{{gin_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no store",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'gin_url')}/default`, 'no-store')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "no-store",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{gin_url}}/default",
							"host": [
								"{{gin_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Exclude regex",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'gin_url')}/excluded`, '', false, true)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{gin_url}}/excluded",
							"host": [
								"{{gin_url}}"
							],
							"path": [
								"excluded"
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "Skipper",
			"item": [
				{
					"name": "Default",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'skipper_url')}/default`, '', true)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{skipper_url}}/default",
							"host": [
								"{{skipper_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no cache",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'skipper_url')}/default`, 'no-cache')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{skipper_url}}/default",
							"host": [
								"{{skipper_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no store",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'skipper_url')}/default`, 'no-store')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "no-store",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{skipper_url}}/default",
							"host": [
								"{{skipper_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Exclude regex",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'skipper_url')}/excluded`, '', false, true)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{skipper_url}}/excluded",
							"host": [
								"{{skipper_url}}"
							],
							"path": [
								"excluded"
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "Traefik",
			"item": [
				{
					"name": "Default",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, utils.getVar(pm, 'traefik_url'), '', true)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{traefik_url}}",
							"host": [
								"{{traefik_url}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no cache",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, utils.getVar(pm, 'traefik_url'), 'no-cache')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{traefik_url}}",
							"host": [
								"{{traefik_url}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no store",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, utils.getVar(pm, 'traefik_url'), 'no-store')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{traefik_url}}",
							"host": [
								"{{traefik_url}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Exclude regex",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'traefik_url')}/test_exclude_another`, 'cache', false, true)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{traefik_url}}/test_exclude_another",
							"host": [
								"{{traefik_url}}"
							],
							"path": [
								"test_exclude_another"
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "Tyk",
			"item": [
				{
					"name": "Default",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'tyk_url')}/`, '', true)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{tyk_url}}/",
							"host": [
								"{{tyk_url}}"
							],
							"path": [
								""
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no cache",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'tyk_url')}/`, 'no-cache')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{tyk_url}}/",
							"host": [
								"{{tyk_url}}"
							],
							"path": [
								""
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no store",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'tyk_url')}/`, 'no-store')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{tyk_url}}/",
							"host": [
								"{{tyk_url}}"
							],
							"path": [
								""
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "Webgo",
			"item": [
				{
					"name": "Default",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'webgo_url')}/default`, '', true)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{webgo_url}}/default",
							"host": [
								"{{webgo_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no cache",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'webgo_url')}/default`, 'no-cache')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{webgo_url}}/default",
							"host": [
								"{{webgo_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Default no store",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'webgo_url')}/default`, 'no-store')"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "no-store",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{webgo_url}}/default",
							"host": [
								"{{webgo_url}}"
							],
							"path": [
								"default"
							]
						}
					},
					"response": []
				},
				{
					"name": "Exclude regex",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"utils.baseEndpoint(pm, `${utils.getVar(pm, 'webgo_url')}/test2`, '', false, true)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Cache-Control",
								"value": "",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{webgo_url}}/excluded",
							"host": [
								"{{webgo_url}}"
							],
							"path": [
								"excluded"
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"utils = {",
					"    request: (url, cacheControl = '', body = null, headers = {}) => ({",
					"        header: {",
					"            'Cache-Control': cacheControl,",
					"            ...headers,",
					"        },",
					"        method: 'GET',",
					"        body,",
					"        url,",
					"    }),",
					"    getVar: (pm, v) => pm.collectionVariables.get(v) || '',",
					"    baseEndpoint: (pm, baseUrl = '', cacheControl = '', isStore = false, exclude = false) => {",
					"        pm.test(\"Status code is 200 with Cache-Status header\", function () {",
					"            pm.response.to.have.status(200);",
					"            if (exclude) {",
					"                pm.response.to.have.header(\"Cache-Status\");",
					"                pm.expect(pm.response.headers.get(\"Cache-Status\")).to.eql(\"Souin; fwd=uri-miss\");",
					"            } else {",
					"                pm.response.to.have.header(\"Cache-Status\");",
					"                if (isStore) {",
					"                    pm.expect(pm.response.headers.get(\"Cache-Status\")).to.eql(\"Souin; fwd=uri-miss; stored\");",
					"                } else {",
					"                    pm.response.to.have.header(\"Cache-Status\");",
					"                    pm.expect(pm.response.headers.get(\"Cache-Status\")).to.eql(\"Souin; fwd=uri-miss\");",
					"                }",
					"            }",
					"            pm.response.to.not.have.header(\"Age\");",
					"        });",
					"        pm.sendRequest(utils.request(baseUrl, cacheControl), function (_, response) {",
					"            pm.test(`Status code is 200, Cache-Status and Age are ${cacheControl === '' ? '' : 'not '}present`, function () {",
					"                    const expected = pm.expect(response);",
					"                    expected.to.have.status(200);",
					"                    if (exclude) {",
					"                        pm.response.to.have.header(\"Cache-Status\");",
					"                        pm.expect(pm.response.headers.get(\"Cache-Status\")).to.eql(\"Souin; fwd=uri-miss\");",
					"                    } else {",
					"                        expected.to.have.header(\"Cache-Status\");",
					"",
					"                        if (cacheControl == '') {",
					"                            expected.to.have.header(\"Age\");",
					"                            pm.expect(response.headers.get(\"Cache-Status\")).to.include(\"Souin; hit; ttl=\");",
					"                        } else {",
					"                            expected.to.not.have.header(\"Age\");",
					"                            pm.expect(response.headers.get(\"Cache-Status\")).to.eql(\"Souin; fwd=uri-miss\");",
					"                        }",
					"                    }",
					"                }",
					"            );",
					"        });",
					"    },",
					"    serveHTTPError: (pm, baseUrl = '') => {",
					"        pm.test(\"Status code is 502 with Cache-Status header\", function () {",
					"            pm.response.to.have.status(502);",
					"            pm.response.to.have.header(\"Cache-Status\");",
					"            pm.expect(pm.response.headers.get(\"Cache-Status\")).to.eql(\"Souin; fwd=uri-miss\");",
					"            pm.response.to.not.have.header(\"Age\");",
					"        });",
					"        pm.sendRequest(utils.request(baseUrl, ''), function (_, response) {",
					"            pm.test('Status code is 200, Cache-Status is present without Age', function () {",
					"                const expected = pm.expect(response);",
					"                expected.to.have.status(502);",
					"                expected.to.have.header(\"Cache-Status\");",
					"                pm.expect(response.headers.get(\"Cache-Status\")).to.eql(\"Souin; fwd=uri-miss\");",
					"                pm.response.to.not.have.header(\"Age\");",
					"            });",
					"        });",
					"    },",
					"    validateAge: (pm, age, baseUrl = '') => {",
					"        pm.test(\"Status code is 200 with Cache-Status header\", function () {",
					"            pm.response.to.have.status(200);",
					"            pm.response.to.have.header(\"Cache-Status\");",
					"            pm.expect(pm.response.headers.get(\"Cache-Status\")).to.eql(\"Souin; fwd=uri-miss; stored\");",
					"            pm.response.to.not.have.header(\"Age\");",
					"        });",
					"        pm.sendRequest(utils.request(baseUrl, ''), function (_, response) {",
					"            pm.test('Status code is 200, Cache-Status and Age are present', function () {",
					"                const expected = pm.expect(response);",
					"                expected.to.have.status(200);",
					"                expected.to.have.header(\"Cache-Status\");",
					"                expected.to.have.header(\"Age\");",
					"                pm.expect(response.headers.get(\"Cache-Status\")).to.include(\"Souin; hit; ttl=\"+age);",
					"            });",
					"        });",
					"    },",
					"    validateVary: (pm, baseUrl = '') => {",
					"        pm.test(\"Status code is 200 with Cache-Status header\", function () {",
					"            pm.response.to.have.status(200);",
					"            pm.response.to.have.header(\"Cache-Status\");",
					"            pm.expect(pm.response.headers.get(\"Cache-Status\")).to.eql(\"Souin; fwd=uri-miss; stored\");",
					"            pm.response.to.not.have.header(\"Age\");",
					"            pm.expect(pm.response.text()).to.eql(\"Hello should-vary-1\");",
					"        });",
					"        const vary1 = utils.request(baseUrl, '', null, {'X-Something': 'should-vary-1'});",
					"        const vary2 = utils.request(baseUrl, '', null, {'X-Something': 'should-vary-2'});",
					"        pm.sendRequest(vary1, function (_, resVary1) {",
					"            pm.test('Status code is 200, Cache-Status and Age are present', function () {",
					"                const expected = pm.expect(resVary1);",
					"                expected.to.have.status(200);",
					"                expected.to.have.header(\"Cache-Status\");",
					"                expected.to.have.header(\"Age\");",
					"                pm.expect(resVary1.headers.get(\"Cache-Status\")).to.include(\"Souin; hit; ttl=14\");",
					"                pm.expect(resVary1.text()).to.eql(\"Hello should-vary-1\");",
					"            });",
					"",
					"",
					"            pm.sendRequest(vary2, function (_, resVary2Stored) {",
					"                pm.test(\"Status code is 200 with Cache-Status header\", function () {",
					"                    const expected = pm.expect(resVary2Stored);",
					"                    expected.to.have.status(200);",
					"                    expected.to.have.header(\"Cache-Status\");",
					"                    pm.expect(resVary2Stored.headers.get(\"Cache-Status\")).to.eql(\"Souin; fwd=uri-miss; stored\");",
					"                    expected.to.not.have.header(\"Age\");",
					"                    pm.expect(resVary2Stored.text()).to.eql(\"Hello should-vary-2\");",
					"                });",
					"",
					"                pm.sendRequest(vary2, function (_, resVary2) {",
					"                    pm.test('Status code is 200, Cache-Status and Age are present', function () {",
					"                        const expected = pm.expect(resVary2);",
					"                        expected.to.have.status(200);",
					"                        expected.to.have.header(\"Cache-Status\");",
					"                        expected.to.have.header(\"Age\");",
					"                        pm.expect(resVary2.headers.get(\"Cache-Status\")).to.include(\"Souin; hit; ttl=14\");",
					"                        pm.expect(resVary2.text()).to.eql(\"Hello should-vary-2\");",
					"                    });",
					"                });",
					"            });",
					"        });",
					"    },",
					"    souinAPI: {",
					"        listKeys: (pm, baseKey, baseUrl = '', additionalPath = '', cacheControl = '') => {",
					"            const isCached = cacheControl == ''",
					"            pm.test(\"Ensure stored keys array is empty\", function () {",
					"                pm.response.to.have.status(200);",
					"                let jsonData = pm.response.json();",
					"                pm.expect(jsonData).to.eql([]);",
					"                pm.expect(jsonData.length).to.eql(0);",
					"            });",
					"            pm.sendRequest(utils.request(baseUrl + additionalPath, cacheControl), function(_, response) {",
					"                pm.expect(response).to.have.status(200);",
					"            });",
					"",
					"            ",
					"            pm.sendRequest(utils.request(`${baseUrl}${utils.getVar(pm, 'souin_base_api')}${utils.getVar(pm, 'souin_api')}`, cacheControl), function (_, res) {",
					"                pm.test(`Check Souin API has ${isCached ? 'two' : 'none'} registered key after the first cache set`, function () {",
					"                        pm.expect(res).to.have.status(200);",
					"                        let jsonData = res.json();",
					"                        pm.expect(jsonData.length).to.eql(isCached ? 2 : 0);",
					"                        pm.expect(jsonData[0]).to.eql(isCached ? baseKey : undefined);",
					"                    }",
					"                );",
					"",
					"                pm.sendRequest(utils.request(baseUrl + additionalPath + 'testing', cacheControl), function() {",
					"                    pm.sendRequest(utils.request(`${baseUrl}${utils.getVar(pm, 'souin_base_api')}${utils.getVar(pm, 'souin_api')}`, cacheControl), function (_, r) {",
					"                        pm.test(`Check Souin API has ${isCached ? 'four' : 'none'} registered key${isCached ? 's' : ''} after the second cache set`, function () {",
					"                            pm.expect(r).to.have.status(200);",
					"                            pm.expect(r).to.not.have.header(\"Cache-Status\");",
					"                            pm.expect(r).to.not.have.header(\"Age\");",
					"                            let jsonData = r.json();",
					"                            pm.expect(jsonData.length).to.eql(isCached ? 4 : 0);",
					"                        });",
					"                    });",
					"                });",
					"            });",
					"        },",
					"        listGraphQLKeys: (pm, baseKey, baseUrl = '', additionalPath = '', cacheControl = '') => {",
					"            const isCached = cacheControl == ''",
					"            const body = {",
					"                mode: \"raw\",",
					"                raw: JSON.stringify({\"query\":{\"mutation\": \"something\"}})",
					"            }",
					"            const rq = utils.request(baseUrl + additionalPath, '', body)",
					"            rq.method = \"POST\"",
					"            pm.test(\"Ensure stored keys array is empty\", function () {",
					"                pm.response.to.have.status(200);",
					"                let jsonData = pm.response.json();",
					"                pm.expect(jsonData).to.eql([]);",
					"                pm.expect(jsonData.length).to.eql(0);",
					"            });",
					"            pm.sendRequest(rq, function(_, response) {",
					"                pm.expect(response).to.have.status(200);",
					"            });",
					"",
					"            pm.sendRequest(utils.request(`${baseUrl}${utils.getVar(pm, 'souin_base_api')}${utils.getVar(pm, 'souin_api')}`, cacheControl), function (_, res) {",
					"                pm.test(`Check Souin API has ${isCached ? 'two' : 'none'} registered key after the first cache set`, function () {",
					"                        pm.expect(res).to.have.status(200);",
					"                        let jsonData = res.json();",
					"                        pm.expect(jsonData.length).to.eql(isCached ? 2 : 0);",
					"                        pm.expect(jsonData[0]).to.include(isCached ? baseKey : undefined);",
					"                    }",
					"                );",
					"",
					"                rq.url = baseUrl + additionalPath + 'testing'",
					"                pm.sendRequest(rq, function() {",
					"                    pm.sendRequest(utils.request(`${baseUrl}${utils.getVar(pm, 'souin_base_api')}${utils.getVar(pm, 'souin_api')}`, cacheControl), function (_, r) {",
					"                        pm.test(`Check Souin API has ${isCached ? 'four' : 'none'} registered key${isCached ? 's' : ''} after the second cache set`, function () {",
					"                            pm.expect(r).to.have.status(200);",
					"                            pm.expect(r).to.not.have.header(\"Cache-Status\");",
					"                            pm.expect(r).to.not.have.header(\"Age\");",
					"                            let jsonData = r.json();",
					"                            pm.expect(jsonData.length).to.eql(isCached ? 4 : 0);",
					"                        });",
					"                    });",
					"                });",
					"            });",
					"        },",
					"    },",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "caddy_url",
			"value": "http://localhost:4443"
		},
		{
			"key": "souin_api",
			"value": "/souin"
		},
		{
			"key": "souin_base_api",
			"value": "/souin-api"
		},
		{
			"key": "traefik_url",
			"value": "http://domain.com"
		},
		{
			"key": "tyk_url",
			"value": "http://localhost:4443/httpbin"
		},
		{
			"key": "echo_url",
			"value": "http://domain.com"
		},
		{
			"key": "gin_url",
			"value": "http://domain.com"
		},
		{
			"key": "skipper_url",
			"value": "http://domain.com"
		},
		{
			"key": "prometheus_api",
			"value": "/metrics"
		},
		{
			"key": "webgo_url",
			"value": "http://domain.com"
		},
		{
			"key": "chi_url",
			"value": "http://domain.com"
		}
	]
}